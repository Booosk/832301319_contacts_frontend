<view class="container">
  <!-- å¤´éƒ¨ -->
  <view class="header card">
    <view class="title-section">
      <text class="title">âœï¸ ç¼–è¾‘è”ç³»äºº</text>
      <text class="subtitle">ä¿®æ”¹è”ç³»äººä¿¡æ¯</text>
      <text class="change-indicator" wx:if="{{hasChanges}}">* æœ‰æœªä¿å­˜çš„æ›´æ”¹</text>
    </view>
    <button class="back-btn" bindtap="onBack">è¿”å›</button>
  </view>


  <!-- è¡¨å• -->
  <view class="form card">
    <!-- ç…§ç‰‡ä¸Šä¼  -->
    <view class="form-item">
      <text class="label">ğŸ“· è”ç³»äººç…§ç‰‡</text>
      <view class="photo-section">
        <view class="photo-upload-area" bindtap="choosePhoto">
          <view wx:if="{{!photo}}" class="upload-placeholder">
            <text class="upload-icon">â•</text>
            <text class="upload-text">{{originalData && originalData.photo ? 'é‡æ–°ä¸Šä¼ ' : 'æ·»åŠ ç…§ç‰‡'}}</text>
            <text class="upload-tip">å¯é€‰ï¼Œæ”¯æŒæ‹ç…§æˆ–ç›¸å†Œ</text>
          </view>
          <view wx:else class="photo-preview" bindtap="previewPhoto">
            <image src="{{photo}}" class="preview-image" mode="aspectFill" />
            <view class="photo-overlay">
              <text class="overlay-text">ç‚¹å‡»é¢„è§ˆ</text>
            </view>
          </view>
        </view>
        
        <button wx:if="{{photo}}" class="remove-photo-btn" bindtap="removePhoto" disabled="{{isUploadingPhoto}}">
          âœ• åˆ é™¤
        </button>
      </view>
      <text wx:if="{{isUploadingPhoto}}" class="uploading-text">ç…§ç‰‡ä¸Šä¼ ä¸­...</text>
    </view>

    <!-- å§“å -->
    <view class="form-item">
      <text class="label required">ğŸ‘¤ å§“å</text>
      <input 
        class="input-field {{errors.name ? 'error' : ''}}"
        value="{{name}}"
        bindinput="onNameInput"
        placeholder="è¯·è¾“å…¥è”ç³»äººå§“å"
        maxlength="20"
      />
      <text class="error-text" wx:if="{{errors.name}}">{{errors.name}}</text>
    </view>

    <!-- ç”µè¯ -->
    <view class="form-item">
      <text class="label required">ğŸ“± æ‰‹æœºå·</text>
      <input 
        class="input-field {{errors.phone ? 'error' : ''}}"
        value="{{phone}}"
        bindinput="onPhoneInput"
        placeholder="è¯·è¾“å…¥11ä½æ‰‹æœºå·"
        type="number"
        maxlength="11"
      />
      <text class="error-text" wx:if="{{errors.phone}}">{{errors.phone}}</text>
    </view>

    <!-- é‚®ç®± -->
    <view class="form-item">
      <text class="label">ğŸ“§ é‚®ç®±</text>
      <input 
        class="input-field {{errors.email ? 'error' : ''}}"
        value="{{email}}"
        bindinput="onEmailInput"
        placeholder="è¯·è¾“å…¥é‚®ç®±åœ°å€ï¼ˆå¯é€‰ï¼‰"
        type="email"
      />
      <text class="error-text" wx:if="{{errors.email}}">{{errors.email}}</text>
    </view>

    <!-- åœ°å€ -->
    <view class="form-item">
      <text class="label">ğŸ  åœ°å€</text>
      <input 
        class="input-field"
        value="{{address}}"
        bindinput="onAddressInput"
        placeholder="è¯·è¾“å…¥è”ç³»åœ°å€ï¼ˆå¯é€‰ï¼‰"
      />
    </view>

    <!-- æŒ‰é’®ç»„ -->
    <view class="button-group">
      <button class="secondary-btn" bindtap="resetForm" disabled="{{isSubmitting || !hasChanges}}">
        é‡ç½®
      </button>
      <!-- ä¸´æ—¶ç§»é™¤ç¦ç”¨çŠ¶æ€è¿›è¡Œæµ‹è¯• -->
      <button class="primary-btn" bindtap="submitForm" disabled="{{isSubmitting}}">
        {{isSubmitting ? 'ä¿å­˜ä¸­...' : 'ä¿å­˜ä¿®æ”¹'}}
      </button>
    </view>
  </view>

  <!-- è”ç³»äººä¿¡æ¯ -->
  <view class="info-card card" wx:if="{{originalData}}">
    <text class="info-title">ğŸ“‹ åŸå§‹ä¿¡æ¯</text>
    <view class="info-item">
      <text class="info-label">è”ç³»äººIDï¼š</text>
      <text class="info-value">{{originalData.id}}</text>
    </view>
    <view class="info-item">
      <text class="info-label">åˆ›å»ºæ—¶é—´ï¼š</text>
      <text class="info-value">{{originalData.created_time}}</text>
    </view>
    <view class="info-item" wx:if="{{originalData.updated_time && originalData.updated_time !== originalData.created_time}}">
      <text class="info-label">æ›´æ–°æ—¶é—´ï¼š</text>
      <text class="info-value">{{originalData.updated_time}}</text>
    </view>
    <view class="info-item" wx:if="{{originalData.photo}}">
      <text class="info-label">åŸæœ‰ç…§ç‰‡ï¼š</text>
      <text class="info-value">å·²ä¸Šä¼ </text>
    </view>
  </view>
</view>